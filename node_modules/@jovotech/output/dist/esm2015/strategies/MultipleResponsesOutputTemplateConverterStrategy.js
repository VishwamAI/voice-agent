import { OutputTemplateConverterStrategy, } from '../OutputTemplateConverterStrategy';
/**
 * Strategy that can have multiple OutputTemplates and multiple Responses.
 */
export class MultipleResponsesOutputTemplateConverterStrategy extends OutputTemplateConverterStrategy {
    normalizeOutput(output) {
        const normalizedOutput = super.normalizeOutput(output);
        if (!this.shouldSanitize()) {
            return normalizedOutput;
        }
        return Array.isArray(normalizedOutput)
            ? normalizedOutput.map((outputItem, index) => this.sanitizeOutput(outputItem, index))
            : this.sanitizeOutput(normalizedOutput);
    }
    toResponse(output) {
        return Array.isArray(output)
            ? output
                .map((outputItem) => this.convertOutput(outputItem))
                .reduce((accumulator, currentValue) => {
                if (Array.isArray(currentValue)) {
                    accumulator.push(...currentValue);
                }
                else {
                    accumulator.push(currentValue);
                }
                return accumulator;
            }, [])
            : this.convertOutput(output);
    }
    fromResponse(responseOrResponses) {
        return Array.isArray(responseOrResponses)
            ? responseOrResponses.map((responseItem) => this.convertResponse(responseItem))
            : this.convertResponse(responseOrResponses);
    }
}
//# sourceMappingURL=MultipleResponsesOutputTemplateConverterStrategy.js.map